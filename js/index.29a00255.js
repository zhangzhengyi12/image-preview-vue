(function(e){function a(a){for(var i,s,o=a[0],l=a[1],c=a[2],h=0,d=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);g&&g(a);while(d.length)d.shift()();return r.push.apply(r,c||[]),t()}function t(){for(var e,a=0;a<r.length;a++){for(var t=r[a],i=!0,o=1;o<t.length;o++){var l=t[o];0!==n[l]&&(i=!1)}i&&(r.splice(a--,1),e=s(s.s=t[0]))}return e}var i={},n={index:0},r=[];function s(a){if(i[a])return i[a].exports;var t=i[a]={i:a,l:!1,exports:{}};return e[a].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=i,s.d=function(e,a,t){s.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,a){if(1&a&&(e=s(e)),8&a)return e;if(4&a&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var i in e)s.d(t,i,function(a){return e[a]}.bind(null,i));return t},s.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(a,"a",a),a},s.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=a,o=o.slice();for(var c=0;c<o.length;c++)a(o[c]);var g=l;r.push([0,"chunk-vendors"]),t()})({0:function(e,a,t){e.exports=t("c31f")},3881:function(e,a,t){},4790:function(e,a,t){"use strict";var i=t("98ee"),n=t.n(i);n.a},"98ee":function(e,a,t){},ae78:function(e,a,t){},c31f:function(e,a,t){"use strict";t.r(a);var i=t("2b0e"),n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"app"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.config,expression:"config"}],attrs:{rows:"20"},domProps:{value:e.config},on:{input:function(a){a.target.composing||(e.config=a.target.value)}}}),e._v(" "),t("div",{staticClass:"desc"},[e._v("尝试修改配置并点击下方按钮")]),t("div",{staticClass:"show",on:{click:e.handleTapImage}},[e._v("点我查看大图")])])},r=[],s={name:"App",data(){return{config:'\n{\n  "initIndex": 1,\n  "images": [\n    "https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg",\n    "https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"\n  ],\n  "isEnableBlurBackground": true,\n  "isEnableLoopToggle": true,\n  "initViewMode": "contain",\n  "shirnkAndEnlargeDeltaRatio": 0.2,\n  "wheelScrollDeltaRatio": 1,\n  "isEnableImagePageIndicator": true\n}\n      '}},methods:{handleTapImage(){let e={};try{e=JSON.parse(this.config)}catch(a){alert("JSON解析失败")}this.$previewImage(e)}}},o=s,l=(t("cf52"),t("2877")),c=Object(l["a"])(o,n,r,!1,null,"5a1b84f6",null),g=c.exports,h=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("transition",{attrs:{name:"preview-anima"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"image-preview"},[e.config.facade.isEnableBlurBackground?t("div",{staticClass:"image-preview__blur-layer",style:"background-image:url("+e.core.cacheBlurImageUrl+")"}):e._e(),t("img",{class:["image-preview__image",e.imageStateClassName],style:e.imageStyle,attrs:{src:e.currentImageSrc,draggable:"false",alt:""},on:{load:e.handleImageLoaded,mousedown:e.handleImageDragStart,mouseup:e.handleImageDragEnd,mousemove:e.handleImageDragMove}}),t("div",{staticClass:"image-preview__action-layer"},[e.config.feature.isEnableImagePageIndicator?t("div",{staticClass:"image-preview__page-info"},[e._v(e._s(e.currentIndex+1)+"/"+e._s(e.core.images.length))]):e._e(),t("div",{staticClass:"image-preview__close image-preview__cir-action",on:{click:e.handleTapClose}},[t("i",{staticClass:"zip zipclose"})]),e.hasPrevImage?t("div",{staticClass:"image-preview__prev image-preview__cir-action",on:{click:e.handleTapPrev}},[t("i",{staticClass:"zip zipprev"})]):e._e(),e.hasNextImage?t("div",{staticClass:"image-preview__next image-preview__cir-action",on:{click:e.handleTapNext}},[t("i",{staticClass:"zip zipnext"})]):e._e(),t("div",{staticClass:"image-preview__action-bar"},[t("div",{staticClass:"image-preview__action-rotate-left action-btn image-preview__cir-action",on:{click:e.handleTapRotateLeft}},[t("i",{staticClass:"zip zipnishizhenxuanzhuan"})]),t("div",{staticClass:"image-preview__action-rotate-right action-btn image-preview__cir-action",on:{click:e.handleTapRotateRight}},[t("i",{staticClass:"zip zipshunshizhenxuanzhuan"})]),t("div",{staticClass:"image-preview__action-full-screen action-btn image-preview__cir-action",on:{click:e.handleTapfullscreen}},[t("i",{class:"zip "+(e.core.fullscreenMode?"zipadapt":"zipfull_screen")})]),t("div",{staticClass:"image-preview__action-scale-big action-btn image-preview__cir-action",on:{click:e.handleTapEnlarge}},[t("i",{staticClass:"zip zipfangda"})]),t("div",{staticClass:"image-preview__full-scale-small action-btn image-preview__cir-action",on:{click:e.handleTapShrink}},[t("i",{staticClass:"zip zipsuoxiao"})])])])])])},d=[];class u{constructor(e,a){this.deltaRatio=e,this.changeCallback=a,this.wheelScrollHandlerBindThis=e=>{this.wheelScrollHanlder(e)},this.initListener()}initListener(){window.addEventListener("wheel",this.wheelScrollHandlerBindThis)}removeListener(){window.removeEventListener("wheel",this.wheelScrollHandlerBindThis)}wheelScrollHanlder({deltaY:e}){const a=e>=0?1:-1,t=.1*this.deltaRatio;this.changeCallback(a*t)}}const p={ROTATE:1,SCALE:2,DRAG:3};var m={name:"zzy-image-preview",data(){return{visible:!1,core:{index:0,images:[],cacheBlurImageUrl:"",imageRotate:0,fullscreenMode:!1,scaleRatio:1,actionState:p.ROTATE},drag:{onDrag:!1,lastPageX:0,lastPageY:0,transformX:0,transformY:0},config:{facade:{isEnableBlurBackground:!1},feature:{isEnableLoopToggle:!1,isEnableImagePageIndicator:!0,wheelScrollDeltaRatio:1,shirnkAndEnlargeDelta:.2}}}},computed:{imageStateClassName(){return this.core.actionState===p.ROTATE?"is-rotate":this.core.actionState===p.SCALE?"is-scale":"is-drag"},currentIndex(){return this.config.feature.isEnableLoopToggle?Math.abs(this.core.index)%this.core.images.length:this.core.index},hasPrevImage(){return!!this.config.feature.isEnableLoopToggle||!!this.core.images[this.currentIndex-1]},hasNextImage(){return!!this.config.feature.isEnableLoopToggle||!!this.core.images[this.currentIndex+1]},currentImageSrc(){return this.core.images[this.currentIndex]},imageStyle(){const e=`rotate(${this.core.imageRotate}deg)`,a=`scale(${this.core.scaleRatio})`,t=`translate(${this.drag.transformX}px,${this.drag.transformY}px)`,i=`transform:${t} ${e} ${a} ;`,n=`object-fit: ${this.core.fullscreenMode?"cover":"contain;"};`;return i+n}},mounted(){this.visible=!0},methods:{initWithOptions(e){this.WheelScaleHandler=new u(e.wheelScrollDeltaRatio,this.handleWheelScrollChange),this.core.index=(()=>e.initIndex<0?0:e.initIndex>=e.images.length?e.images.length-1:e.initIndex)(),this.core.images=e.images,this.config.facade.isEnableBlurBackground=e.isEnableBlurBackground,this.config.feature.isEnableLoopToggle=e.isEnableLoopToggle,this.config.feature.isEnableImagePageIndicator=e.isEnableImagePageIndicator,this.core.fullscreenMode="contain"!==e.initViewMode,this.config.feature.shirnkAndEnlargeDeltaRatio=e.shirnkAndEnlargeDeltaRatio},togglePrev(){this.core.index--,this.resetActionStyle()},toggleNext(){this.core.index++,this.resetActionStyle()},close(){this.visible=!1,setTimeout(()=>{this.$destroy(),this.$el.parentNode.removeChild(this.$el)},300)},setScaleRatio(e){this.core.scaleRatio=e<.3?.3:e>5?5:e},resetActionStyle(){this.core.scaleRatio=1,this.drag.transformX=0,this.drag.transformY=0},handleImageLoaded(e){this.$nextTick(()=>{this.core.cacheBlurImageUrl=this.currentImageSrc})},handleTapClose(){this.close()},handleTapPrev(){this.togglePrev()},handleTapNext(){this.toggleNext()},handleTapRotateLeft(){this.core.actionState=p.ROTATE,this.core.imageRotate-=90},handleTapRotateRight(){this.core.actionState=p.ROTATE,this.core.imageRotate+=90},handleTapfullscreen(){this.resetActionStyle(),this.core.fullscreenMode=!this.core.fullscreenMode},handleWheelScrollChange(e){this.core.actionState=p.SCALE,this.setScaleRatio(this.core.scaleRatio-e)},handleTapShrink(){this.core.actionState=p.ROTATE,this.setScaleRatio(this.core.scaleRatio-this.config.feature.shirnkAndEnlargeDeltaRatio)},handleTapEnlarge(){this.core.actionState=p.ROTATE,this.setScaleRatio(this.core.scaleRatio+this.config.feature.shirnkAndEnlargeDeltaRatio)},handleImageDragStart(e){this.drag.onDrag=!0,this.drag.lastPageX=e.pageX,this.drag.lastPageY=e.pageY},handleImageDragMove(e){if(!this.drag.onDrag)return;this.core.actionState=p.DRAG;const a=e.pageX-this.drag.lastPageX,t=e.pageY-this.drag.lastPageY;this.drag.transformX+=a,this.drag.transformY+=t,this.drag.lastPageX=e.pageX,this.drag.lastPageY=e.pageY},handleImageDragEnd(e){this.drag.onDrag=!1,this.core.actionState=p.ROTATE}}},f=m,v=(t("4790"),Object(l["a"])(f,h,d,!1,null,"648e7e28",null)),b=v.exports;t("ae78");const w={initIndex:0,images:[],isEnableBlurBackground:!1,isEnableLoopToggle:!1,initViewMode:"contain",shirnkAndEnlargeDeltaRatio:.2,wheelScrollDeltaRatio:1,isEnableImagePageIndicator:!1},_=i["a"].extend(b);function S(e=w){let a=new _;return a.initWithOptions({...w,...e}),a.$mount(),document.body.appendChild(a.$el),a}S.install=e=>{e.prototype.$previewImage=S};i["a"].config.productionTip=!1,i["a"].use(S),new i["a"]({render:e=>e(g)}).$mount("#app")},cf52:function(e,a,t){"use strict";var i=t("3881"),n=t.n(i);n.a}});
//# sourceMappingURL=index.29a00255.js.map